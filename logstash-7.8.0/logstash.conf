input {
  udp {
    port => 5514
  }
}

filter {
      mutate {
        remove_field => ["host","agent","input","ecs"]
      }
   else if "1.1.1.9" in [log][file][path] and "snat+dnat" in [message]  {
        grok {
          match => {
            "[message]" => "<%{NUMBER}>date=(?<date>%{YEAR}-%{MONTHNUM}-%{MONTHDAY})%{SPACE}time=%{NOTSPACE:time}%{SPACE}(devname=(\")%{NOTSPACE:device})(\")%{SPACE}?(devid=%{NOTSPACE}%{SPACE})?((logid=%{NOTSPACE}%{SPACE})?(type=%{NOTSPACE}%{SPACE})?(subtype=%{NOTSPACE}%{SPACE})?(eventtype=((\\)|(\"))?(?<eventtype>[^\"]*)(\\|\")?%{SPACE})?level=((\\)|(\"))?(?<level>[^\"]*)(\\|\")?%{SPACE}(vd=((\\)|(\"))?(?<vdom>[^\"]*)(\\|\")?%{SPACE})?)?(eventtime=%{NOTSPACE}%{SPACE})?(tz=%{NOTSPACE}%{SPACE})?((logid=%{NOTSPACE}%{SPACE})?(type=%{NOTSPACE}%{SPACE})?(subtype=%{NOTSPACE}%{SPACE})?level=((\\)|(\"))?(?<level>[^\"]*)(\\|\")?%{SPACE}(vd=((\\)|(\"))?(?<vdom>[^\"]*)(\\|\")?%{SPACE})?)?((srcip=(\")?%{IP:sip}(\")?%{SPACE})?(srcname=.*%{SPACE})?(identifier=.*%{SPACE})?(srcport=%{NUMBER:sport}%{SPACE})?(srcintf=(\\)?(\")?%{NOTSPACE}(\\)?(\")?%{SPACE})?(srcintfrole=%{NOTSPACE}%{SPACE})?dstip=%{IP:dip}%{SPACE}(dstport=%{NUMBER:dport}%{SPACE})?(dstintf=%{NOTSPACE}%{SPACE})?(dstintfrole=%{NOTSPACE}%{SPACE})?(poluuid=%{NOTSPACE}%{SPACE})?(srccountry=(\\|\")?(?<srccountry>[^\"]*)(\\|\")?%{SPACE})?(dstcountry=(\\|\")?(?<dstcountry>[^\"]*)(\\|\")?%{SPACE})?(sessionid=%{NOTSPACE}%{SPACE})?(proto=%{NOTSPACE:protocol}%{SPACE})?action=((\\)|(\"))?(?<action>[^\"]*)(\\|\")?%{SPACE}?policyid=%{NUMBER:policyid}%{SPACE}(.*)?service=((\\)|(\"))?(?<service>[^\"]*)(\\|\")?%{SPACE}?((.*)?(tranip=%{IP:dnat_ip}%{SPACE})(tranport=%{NUMBER:dnat_port}%{SPACE})?(transip=%{IP:snat_ip}%{SPACE})?(transport=%{NUMBER:snat_port}%{SPACE})?(duration=%{NUMBER:duration}%{SPACE})(sentbyte=(?<sent_bytes>\d+)%{SPACE})?(rcvdbyte=(?<rcvd_bytes>\d+)%{SPACE})?(sentpkt=%{NUMBER:packet_sent}%{SPACE})?(rcvdpkt=%{NUMBER:packet_received}%{SPACE})?)?|policyid=%{NUMBER:policyid}%{SPACE}(.*)?(qname=((\\)|(\"))?(?<qname>[^\"]*)(\\|\")?%{SPACE})?qtype=%{NOTSPACE}%{SPACE}qtypeval=%{NOTSPACE}%{SPACE}qclass=%{NOTSPACE}%{SPACE}msg=((\\)|(\"))?(?<msg>[^\"]*)(\\|\")?%{SPACE}action=((\\)|(\"))?(?<action>[^\"]*)(\\|\")?%{SPACE}error=((\\)|(\"))?(?<error>[^\"]*)(\\|\")?%{SPACE}|logdesc=((\\)|(\"))?(?<logdesc>[^\"]*)(\\|\")?%{SPACE}(action=(\\|\")?(?<action>[^\"]*)(\\|\")?%{SPACE}cpu=(\\|\")?(?<cpu>[^\"\s]*)(\\|\")?%{SPACE}mem=(\\|\")?(?<mem>[^\"\s]*)(\\|\")?%{SPACE}totalsession=(\\|\")?(?<totalsession>[^\"\s]*)(\\|\")?%{SPACE}disk=(\\|\")?(?<disk>[^\"\s]*)(\\|\")?%{SPACE}bandwidth=(\\|\")?(?<bandwidth>[^\"\s]*)(\\|\")?%{SPACE}setuprate=(\\|\")?(?<setuprate>[^\"\s]*)(\\|\")?%{SPACE}disklograte=(\\|\")?(?<disklograte>[^\"\s]*)(\\|\")?%{SPACE}fazlograte=(\\|\")?(?<fazlograte>[^\"\s]*)(\\|\")?%{SPACE}freediskstorage=(\\|\")?(?<freediskstorage>[^\"\s]*)(\\|\")?%{SPACE}sysuptime=(\\|\")?(?<sysuptime>[^\"\s]*)(\\|\")?%{SPACE}(waninfo=%{DATA}%{SPACE})?|.*)(msg=(\\|\")?(?<msg>[^\"]*)(\\|\")?%{SPACE})?)"
          }
        }
      }

output {
     elasticsearch {
        hosts => ["192.168.102.185:9200"]
    }
}
